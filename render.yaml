services:
  - type: web
    name: crypto-scanner
    env: node
    buildCommand: |
      npm install
      if command -v python3 &> /dev/null; then
        echo "üêç Python3 found: $(python3 --version)"
        echo "üì¶ Installing Python packages..."
        # Try user install first (works on most systems)
        python3 -m pip install --user --no-cache-dir numpy pandas scipy 2>&1 || \
        # Fallback: try without --user (might need permissions)
        (python3 -m pip install --no-cache-dir numpy pandas scipy 2>&1 || \
        echo "‚ö†Ô∏è Python packages installation failed - bot will use JavaScript fallback (this is OK!)")
        # Verify installation
        python3 -c "import numpy; print('‚úÖ numpy installed')" 2>&1 || echo "‚ö†Ô∏è numpy not found"
        python3 -c "import pandas; print('‚úÖ pandas installed')" 2>&1 || echo "‚ö†Ô∏è pandas not found"
      else
        echo "‚ö†Ô∏è Python3 not found - bot will use JavaScript fallback (works perfectly!)"
      fi
    startCommand: npm start
    healthCheckPath: /health
    plan: free
    # Increase health check timeout for slow free tier instances
    healthCheckMaxRetries: 3
    healthCheckInterval: 30
    healthCheckTimeout: 10
    envVars:
      - key: NODE_ENV
        value: production

